
@{
    ViewBag.Title = "Search";
}
<div class="mt-5 d-flex justify-center align-items-center flex-column pt-5">

    <h2>Search</h2>

    <form>
        <input type="text" name="prompt" value="" id="prompt" />
        <button class="btn btn-dark" type="button" id="invia">invia</button>
    </form>
    <div id="text">

    </div>
        <p class="d-none" id="hidden">Ti consiglio questi prodotti:</p>
    <div id="products">
    </div>
</div>



@section Scripts
{
    @Scripts.Render("~/bundles/jqueryval")

<script type="text/javascript">
    $(document).ready(function () {
        console.log("ciao")
        $("#invia").click(function () {
            var prompt = $("#prompt").val()
            console.log(prompt)

            $.ajax({
                method: 'GET',
                url: "SearchGptAsync",
                data: { prompt: prompt },
                success: function (data) {
                    console.log("Chiamata AJAX riuscita");
                    console.log(data)
                    $("#text").html(data.res);
                    $("#hidden").removeClass("d-none")
                    $("#hidden").addClass("d-block")
                    $.each(data, function (i, v) {

                        var productList = '<div class="container">';

                        $.each(data.prodotti, function (index, product) {
                            productList += ` <div class="col-md-6 col-lg-3 mb-5 mb-lg-0 d-flex flex-column justify-content-between">
       <div>

           <div class="bg-image ripple hover-zoom shadow-5 rounded-5 mb-3" data-mdb-ripple-color="light">
               <img src="../Content/img/${product.FotoCopertina}" alt="Mug 1" class="w-100" />
               <a href="/Prodotti/DettagliProdotto?id=${product.IdProdotti}">
                   <div class="mask"></div>
               </a>
           </div>
           <div class="d-flex justify-content-between">
               <h6>${product.NomeProdotto}</h6>
               <h6>${product.Prezzo}</h6>
           </div>
       </div>

       <div>


           <div class="d-flex w-100 justify-content-center mt-3">


                   <a href="/Ordini/AggiungiAlCarrello?id=${product.IdProdotti}" class="btn btn-dark link-light">Aggiungi al carrello <i class=" ms-2 fas fa-shopping-bag"></i></a>


               </div>
           </div>
       </div>`
                            });
                            productList += '</div>';

                            // Inserisci la lista di prodotti nell'elemento "products"
                            $('#products').html(productList);
                        })

                    }
                })
            })




        })




</script>



} 